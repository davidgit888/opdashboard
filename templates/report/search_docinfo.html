{% load staticfiles %}
<script src="{% static 'js/jquery-3.3.1.js' %}"></script> 
<link href="{% static 'css/table.css' %}" rel="stylesheet">  
<script>

    var all_results = '{{result|safe}}';
    var all_type_info = '{{doc_type_result|safe}}';
    var results = $.parseJSON(all_results);
    var type_info = $.parseJSON(all_type_info);
    var r_len = Object.keys(results["info"])['length'];
    var t_len = Object.keys(type_info['id'])['length'];
    var doc_list = '{{doc_id|safe}}';
    var jdoc_list = $.parseJSON(doc_list);

    function refresh(){
        location.reload();
    }
    
    window.onload = function(){
        for(i=0;i<t_len;i++){
            $('#search_table thead tr').append( '<th>'  + type_info["type"][i] + '</th>' );
        }
        
        for(i=0;i<jdoc_list.length;i++){
            
                for(k=0;k<r_len;k++){
                    if(k==0){
                            $('#search_table tbody ').append( '<tr>');
                            $('#search_table tbody ').append( '<td class="link"><u><strong><span style="color:blue">'  + jdoc_list[i] + '</span></strong></u></td>' );
                        }
                    
                  
                    for(j=0;j<t_len;j++){
                        
                        if(results['sfg'][k]==jdoc_list[i] && results['type_id'][k]==type_info['id'][j]){
                            $('#search_table tbody ').append( '<td>'  + results["info"][k] + '</td>' );   
                        }    
                    }
                    
                }
        } 

        $(".link").click(function(){
            var sfg_id=$(this)[0].textContent;
            
            url = '/report/update_docinfo/?sfg='+sfg_id
            newwindow=window.location.href=url;
            if (window.focus) {newwindow.focus()} 
        });

        
        
    }


</script>

<div>
    <br/><br/>
    <h1>归档记录</h1><br/>
    <h4>归档记录查询</h4>
    
    
    
    <div>
        <table id='search_table' style='text-align:center;' border=1 padding=0>
            <thead>
                <tr>
                    <th>SFG</th>
                </tr>
               
                
            </thead>
            <tbody>
                <tr>
                </tr>
            </tbody>
        </table>
    </div>
    <br/><br/>
    <input type='button' value='刷新' onclick='refresh()'>
<div>